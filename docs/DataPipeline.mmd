flowchart LR
    A["Client Input Event"] --> B["Validate Input"]
    B --> C{Valid?}
    C -->|No| D["Block Input"]
    C -->|Yes| E["Send to Hub<br/>PlayerReady / SelectColor"]
    E --> F["Hub Receives Call"]
    F --> G["SessionManager<br/>Update State"]
    G --> H["Check Game Logic<br/>Ready? All Set?"]
    H --> I{Condition Met?}
    I -->|Yes| J["Trigger State Change<br/>e.g. StartCountdown"]
    I -->|No| K["Wait for More Events"]
    J --> L["BroadcastRoomState"]
    K --> L
    L --> M["SignalR Sends<br/>gameState payload"]
    M --> N["All Clients Receive<br/>gameState event"]
    N --> O["Update Canvas<br/>Render Loop"]
    O --> P["Player Sees Update"]
    P --> Q["Animation Frames<br/>Display Position"]
    Q --> R["Game Loop<br/>100ms Tick"]
    R --> S["Server Tick<br/>Check Win Condition"]
    S --> T{Winner?}
    T -->|Yes| U["Broadcast gameOver"]
    T -->|No| R
    U --> V["Client Receives<br/>gameOver event"]
    V --> W["Show Winner Screen"]
    
    style A fill:#fff3e0,stroke:#e65100,color:#000
    style B fill:#fff3e0,stroke:#e65100,color:#000
    style C fill:#fff9c4,stroke:#f57f17,color:#000
    style D fill:#ffebee,stroke:#c62828,color:#000
    style E fill:#e0f2f1,stroke:#004d40,color:#000
    style F fill:#e8f5e9,stroke:#1b5e20,color:#000
    style G fill:#e8f5e9,stroke:#1b5e20,color:#000
    style H fill:#e8f5e9,stroke:#1b5e20,color:#000
    style I fill:#fff9c4,stroke:#f57f17,color:#000
    style J fill:#e0f2f1,stroke:#004d40,color:#000
    style K fill:#fce4ec,stroke:#880e4f,color:#000
    style L fill:#e8f5e9,stroke:#1b5e20,color:#000
    style M fill:#f3e5f5,stroke:#4a148c,color:#fff
    style N fill:#fff3e0,stroke:#e65100,color:#000
    style O fill:#fff3e0,stroke:#e65100,color:#000
    style P fill:#fff3e0,stroke:#e65100,color:#000
    style Q fill:#fff3e0,stroke:#e65100,color:#000
    style R fill:#e8f5e9,stroke:#1b5e20,color:#000
    style S fill:#fff9c4,stroke:#f57f17,color:#000
    style T fill:#fff9c4,stroke:#f57f17,color:#000
    style U fill:#f3e5f5,stroke:#4a148c,color:#fff
    style V fill:#fff3e0,stroke:#e65100,color:#000
    style W fill:#ffebee,stroke:#c62828,color:#000
